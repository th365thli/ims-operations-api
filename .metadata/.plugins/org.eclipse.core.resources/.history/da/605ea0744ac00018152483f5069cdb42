/*********************************************************************************
 * Licensed Materials - Property of IBM
 * 5655-TAC
 * (C) Copyright IBM Corp. 2013 All Rights Reserved. 
 * US Government Users Restricted Rights - Use, duplication or
 * disclosure restricted by GSA ADP Schedule Contract with 
 * IBM Corp.               
 *********************************************************************************/

package com.ibm.ims.ea.om.pgm.update;

import com.ibm.ims.ea.base.om.common.messages.IQEO;
import com.ibm.ims.ea.om.common.Type2CommandBuilder;

import com.ibm.ims.ea.om.pgm.update.syntax.START._PGM_START;
import com.ibm.ims.ea.om.pgm.update.syntax.STOP._PGM_STOP;


/**
 * <pre>
 * Class implements the ProgramCommand interface to provide a mechanism to build and retrieve TYPE-2 IMSPLEX commands. 
 * As well as the flexibility to build a command, pre-built commands are available through the members such
 * as {@link PgmUpdateCommandBuilder#commandStartTran(String[])}, {@link PgmUpdateCommandBuilder#commandStopTran(String[])}
 * 
 * To use the build command function provided:
 * <code>
 * Create a instance of the command builder
 * ProgramCommandBuilder programCommandBuilder = new programCommandBuilder();
 * 
 * //Instruct the command builder to create a custom command or you can use one of the predefined ones.
 * String cmd = programCommandBuilder.commandStartPgm(pgm);
 * </code>
 * 
 * Example Usage:
 * public static void main(String args[]) {
		 ProgramCommandBuilder pgm = new ProgramCommandBuilder();
		 pgm.setStart(new _PGM_START[]{_PGM_START.SCHD});
		 pgm.setRoute(new String[] {"TEST123"});
		 System.out.println(pgm.getCommand());
	}
 * </pre>
 *
 */
public class PgmUpdateCommandBuilder extends Type2CommandBuilder implements PgmUpdateCommand {
	
	private static String commandPrefix = "UPDATE PGM";
	
	/**
	 * Sets 1-8 character name of the Program
	 */
	@Override
	public void setName(String[] values) throws IllegalArgumentException {
		StringBuffer temp = new StringBuffer("NAME(");

		for (String name : values) {
			int name_length = name.trim().length();

			if (name_length == 0 || name_length > 8) {
				throw new IllegalArgumentException(IQEO.IQEO0009E.msg(new Object[] { "(Name = " + name + ", length = " + name_length }));
			}

			temp.append(name);

			temp.append(COMMA);
			
		}
		temp.append(CLOSEPARANTH);
		commandArgs.add(temp.toString());
	}

	/**
	 * Set START values
	 */
	@Override
	public void setStart(_PGM_START[] values) {
		int length = values.length;
		int count = 1;
		StringBuffer temp = new StringBuffer("START(");
        for (_PGM_START status: values) {
        	if(status != null) {
        		temp.append(status);

        		if(length > 1 && count !=length ){
        			count ++;
        			temp.append(COMMA);
        		}
        	}
        }
        temp.append(CLOSEPARANTH);
        commandArgs.add(temp.toString());
	}
	
	/**
	 * Set STOP values
	 */
	@Override
	public void setStop(_PGM_STOP[] values) {
		int length = values.length;
		int count = 1;
		StringBuffer temp = new StringBuffer("STOP(");
        for (_PGM_STOP status: values) {
        	if (status != null) {
	            temp.append(status);
	            
	             if(length > 1 && count !=length ){
	            	count ++;
	            	temp.append(COMMA);
	            }
        	}
        }
        temp.append(CLOSEPARANTH);
        commandArgs.add(temp.toString());
		
	}

	/**
	 * Sets route. 
	 * NOTE: Route must be set last, after other keywords
	 */
	@Override
	public void setRoute(String[] imsName) {
		int length = imsName.length;
		int count = 1;
		StringBuffer temp = new StringBuffer(") ROUTE(");

		for (String name: imsName) {
			temp.append(name);

			if(length > 1 && count !=length ){           
				temp.append(COMMA);   
			}
			count++;
		}
		commandArgs.add(temp.toString());
	}
	
	
	
	
	 /*****************************************************************************************
	  * Some examples on how to use the class structure for type setting a command such as SET
	  *****************************************************************************************/
	  //EXAMPLE usage for SET: CMD(UPDATE TRAN NAME(MY_TRAN) START(SCHD) STOP(Q) SET(CMD,TRAN_1) 
	  //setName(new String[]{tran});
	  //setStart(new _START[]{_START.Q,_START.SCHD,_START.SUSPEND});
	  //setSet(new SET[]{new AOCMD(_AOCMD.CMD),new EDITRTN(_EDITRTN.NAME, "TRAN_1")});

	/**
	 * Returns the command prefix for this command.
	 * This command's prefix is: "UPDATE PGM"
	 */
	@Override
	public String getCommandPrefix() {
		return commandPrefix;
	}
	
	/**
	 * Unavailable for this TYPE2 command
	 */
	@Override @Deprecated
	public String getCommandSubType() {
		return null;
	}
	
	
}
	


